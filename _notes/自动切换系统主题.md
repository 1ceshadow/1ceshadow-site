在Windows中，可以通过编写一个脚本或使用计划任务来自动切换系统主题。我们可以根据系统时间来决定切换到浅色或暗色主题。

### 步骤一：设置 Windows 主题的命令

Windows 10 和更高版本支持通过注册表更改主题的设置。具体来说，您可以通过修改注册表项来控制浅色和深色模式。您可以通过 PowerShell 来修改这些设置。

#### 1. 设置浅色主题
浅色主题的注册表键值如下：
```plaintext
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize
```
在这里，`AppsUseLightTheme` 和 `SystemUseLightTheme` 控制应用程序和系统的主题模式，值为 `0` 表示深色模式，值为 `1` 表示浅色模式。

#### 2. 设置深色主题
深色主题同样是通过修改同一注册表项来实现，将 `AppsUseLightTheme` 和 `SystemUseLightTheme` 的值都设为 `0`。

### 步骤二：创建 PowerShell 脚本

您可以编写 PowerShell 脚本，通过检查当前时间来决定切换到浅色还是深色模式。

#### 示例 PowerShell 脚本：`switch-theme.ps1`

```powershell
# 获取当前小时
$currentHour = (Get-Date).Hour

# 注册表路径
$regKeyPath = "HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize"

# 白天的时间范围：6 AM 到 6 PM
$dayTimeStart = 6
$dayTimeEnd = 18

# 设置浅色模式（白天）
if ($currentHour -ge $dayTimeStart -and $currentHour -lt $dayTimeEnd) {
    # 设置浅色主题
    Set-ItemProperty -Path $regKeyPath -Name "AppsUseLightTheme" -Value 1
    Set-ItemProperty -Path $regKeyPath -Name "SystemUseLightTheme" -Value 1
} else {
    # 设置深色主题
    Set-ItemProperty -Path $regKeyPath -Name "AppsUseLightTheme" -Value 0
    Set-ItemProperty -Path $regKeyPath -Name "SystemUseLightTheme" -Value 0
}

# 刷新系统主题设置
rundll32.exe user32.dll,UpdatePerUserSystemParameters
```

#### 说明：
1. 脚本首先获取当前的小时数 (`$currentHour`)。
2. 通过条件判断判断是否在白天时间范围内（6:00 AM 到 6:00 PM）。
3. 如果是白天，设置注册表中的 `AppsUseLightTheme` 和 `SystemUseLightTheme` 为 `1`，即浅色模式。
4. 如果是晚上，设置为 `0`，即深色模式。

### 步骤三：定时运行脚本

您可以使用 **任务计划程序** 来定期运行这个脚本，以确保白天和晚上自动切换主题。

#### 创建计划任务

1. **打开“任务计划程序”**:
   - 按下 `Win + R`，输入 `taskschd.msc` 并回车，打开任务计划程序。

2. **创建新任务**:
   - 在右侧面板中，点击“创建任务”。
   - 设置任务的基本信息，例如任务名称为“自动切换主题”。

3. **设置触发器**:
   - 点击“触发器”标签，点击“新建”。
   - 你可以设置任务每天定时运行，例如设置为每天的早上 7 点（启动浅色主题），然后设置为晚上 7 点（切换到暗色主题）。

4. **设置操作**:
   - 点击“操作”标签，点击“新建”。
   - 选择“启动程序”，在程序/脚本框中输入 PowerShell 的路径（例如 `powershell.exe`），并在“添加参数”框中输入你的脚本路径（例如 `-File "C:\path\to\your\script.ps1"`）。

5. **设置条件**:
   - 如果需要，可以选择添加一些额外的条件，比如只有在电脑空闲时才运行脚本等。

6. **保存任务**:
   - 设置完触发器和操作后，点击“确定”保存任务。
精简版：
1. 打开 **任务计划程序** (`taskschd.msc`)。
2. 选择 **创建基本任务**。
3. 设置任务的触发条件为 **每天**，并指定时间（例如每隔一个小时运行一次脚本）。
4. 设置操作为 **启动程序**，然后指定脚本的路径（例如 `powershell.exe` 并附带 `-File "C:\path\to\switch-theme.ps1"`）。
5. 保存并退出任务计划程序。


### 总结
使用 PowerShell 脚本可以方便地实现基于时间自动切换 Windows 主题的效果。

你也可以使用一些现成的工具来实现自动切换 Windows 主题，比如：
- **Auto Dark Mode**：一个免费的第三方软件，可以根据时间自动切换 Windows 主题。
- **Task Scheduler + AutoHotkey**：结合 Task Scheduler 和 AutoHotkey 脚本，定时切换主题。

这些方法可以让你的 Windows 系统根据白天和晚上的时间自动切换主题，既方便又实用。

---

体验：有部分不是立马兼容，像文件夹，可能切换主题之后，他部分白部分黑。有时候系统的主题不会切换。
问题：文件夹很奇怪，系统和应用主题都设置成浅色的时候，文件夹显示是以深色为主；主题都设置成深色时，文件夹都以浅色为主。